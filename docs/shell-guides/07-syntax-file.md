---
sidebar_position: 7
---

# 输入输出与文件

本节我们熟悉bash中的输入输出和文件的读写操作。在linux里，几乎所有东西都被设计成文件系统，我们能在用户空间通过文件接口的方式来操作进程，调整内核，操作设备，发送网络请求等。

## 标准输入输出
当一个bash进程启动的时候会产生一个进程id即pid，每个pid下面会打开若干文件，一个文件对应一个文件描述符，由一个数字表示。默认情况下，保留有三个特殊含义的数字0、1、2，分别表示标准输入(stdin)，标准输出(stdout)和标准错误(stderr)。如果我们要打开新的文件描述符而又不和这三个冲突的话就需要从3开始。bash中默认的标准输入是键盘，标准输出和标准错误是屏幕，我们可以对标准输入输出进行重定向。

## 重定向
输入、输出都支持重定向，意思是输入不用键盘而改用其他的，输出也不到屏幕了而是输出到别的地方，例如：
```bash
date >/dev/null
```
上面把date命令的输出重定向到了null黑洞文件，这样屏幕上就不会输出了。

重定向符号 `<` 和 `>` 与输入输出的对应关系如下表所示：

|标准文件|文件描述符|重定向符号|
|---|---|---|
|stdin|0| < |
|stdout|1| 1> |
|stderr|2| 2> |

其中 `>` 默认不带数字就标准输出，所以 `1>` 中的 `1` 可以省略。除了此以外还有更多的重定向符号，常见的有：

|符号|作用|
|---|---|
|> | 覆盖模式 |
|>>| 追加模式|
|&>|同时重定向标准输出和标准错误，覆盖模式|
|&>>|同上，追加模式|
|2>&1| 标准错误重定向到标准输出 |
|>&2|重定向标准输出到标准错误|

下面举个例子：
```bash
#!/bin/bash

log() {
    echo "$*" >>a.log
}

log "$(date)"
log "$(data 2>&1)"
```
执行看下效果：

![redirect](./img/redirect.png)

可以看到log函数把输入重定向到a.log文件，第一行log把date命令的标准输出记录下来，第二行log后面因为执行的一个无效的命令，因此会产生标准错误，使用了重定向把它输出到了标准输出，否则会直接输出到屏幕。
## 管道


